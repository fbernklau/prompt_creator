<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EduPrompt-AT</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="topbar">
      <div class="brand">
        <div class="brand-mark">EP</div>
        <div class="brand-name">EduPrompt-AT</div>
      </div>
      <div class="topbar-actions">
        <button id="btn-new-task" type="button" class="text-btn">Neue Aufgabe</button>
        <button id="btn-library" type="button" class="text-btn">Bibliothek</button>
        <button id="btn-dashboard" type="button" class="text-btn">Dashboard</button>
        <button id="btn-templates" type="button" class="text-btn is-hidden">Templates</button>
        <button id="btn-history" type="button" class="text-btn">Verlauf</button>
        <button id="btn-provider" type="button" class="text-btn">API-Provider</button>
        <button id="btn-options" type="button" class="text-btn">Optionen</button>
        <button id="btn-admin" type="button" class="text-btn is-hidden">Admin</button>
        <span class="user-chip" id="current-user">Benutzer: lade...</span>
      </div>
    </header>

    <main class="main-shell">
      <section id="screen-home" class="screen">
        <h1>Wie kann ich dir heute helfen?</h1>
        <p class="subline">W&auml;hle ein Handlungsfeld aus dem Schulalltag, um einen ma&szlig;geschneiderten KI-Prompt zu erstellen.</p>
        <div id="category-grid" class="card-grid"></div>

        <div class="panel top-space">
          <h3>Template Discovery</h3>
          <p class="subline">Schnellzugriff auf empfohlene, zuletzt genutzte und favorisierte Templates.</p>
          <div class="grid-3 top-space">
            <label class="span-2">Template Suche
              <input id="home-template-search" placeholder="Titel, Kategorie, Unterkategorie..." />
            </label>
            <div class="inline-actions align-end">
              <button id="home-template-search-btn" type="button">Suchen</button>
              <button id="home-template-reset-btn" type="button" class="secondary">Zur&uuml;cksetzen</button>
            </div>
          </div>
          <div id="home-tag-chips" class="chip-row top-space"></div>
          <div class="grid-3 top-space">
            <div>
              <h4 class="section-title"><span class="mini-icon">TOP</span>Empfohlen</h4>
              <div id="home-recommended-list" class="list-cards compact"></div>
            </div>
            <div>
              <h4 class="section-title"><span class="mini-icon">REC</span>Zuletzt genutzt</h4>
              <div id="home-recent-list" class="list-cards compact"></div>
            </div>
            <div>
              <h4 class="section-title"><span class="mini-icon">FAV</span>Favoriten</h4>
              <div id="home-favorites-list" class="list-cards compact"></div>
            </div>
          </div>
          <small id="home-discovery-status" class="hint top-space"></small>
        </div>
      </section>

      <section id="screen-subcategory" class="screen is-hidden">
        <button id="btn-back-home-from-subcat" type="button" class="link-btn">&larr; Zur&uuml;ck zur &Uuml;bersicht</button>
        <h2 id="selected-category-title"></h2>
        <p id="selected-category-desc" class="subline"></p>
        <div id="subcategory-list" class="subcategory-grid top-space"></div>
      </section>

      <section id="screen-form" class="screen is-hidden">
        <div class="step-nav">
          <button id="btn-back-subcat" type="button" class="secondary back-nav-btn">&larr; Zur&uuml;ck zur Unterkategorie-Auswahl</button>
          <button id="btn-back-home-from-form" type="button" class="link-btn">Zur &Uuml;bersicht</button>
        </div>

        <div class="form-header">
          <h2 id="form-category-title"></h2>
          <p id="form-subcategory-title" class="subline"></p>
        </div>

        <form id="prompt-form" class="stack-form">
          <div class="panel panel-soft">
            <h3 id="required-panel-title">Template - Pflichtfelder</h3>
            <small id="validation-hint" class="hint"></small>
            <div id="required-fields-grid" class="grid-2 compact-grid top-space"></div>
          </div>

          <div class="panel">
            <h3 id="optional-panel-title">Template - Optionale Felder</h3>
            <div id="optional-fields-grid" class="grid-2 compact-grid top-space"></div>
          </div>

          <div id="field-pool" class="is-hidden">
            <div id="base-fields-pool" class="is-hidden">
              <label id="wrap-fach"><span id="label-fach">Fach *</span>
                <input id="fach" placeholder="z. B. Digitale Grundbildung" />
                <small id="hint-fach" class="hint">Beispiel: Mathematik, Deutsch, Physik.</small>
              </label>
              <label id="wrap-schulstufe"><span id="label-schulstufe">Schulstufe *</span>
                <input id="schulstufe" placeholder="z. B. 9. Schulstufe" />
                <small id="hint-schulstufe" class="hint">Beispiel: 7. Schulstufe, Sek II.</small>
              </label>
              <label id="wrap-ziel" class="span-2"><span id="label-ziel">Ziel der Aufgabe *</span>
                <textarea id="ziel" rows="3" placeholder="Was soll konkret vorliegen?"></textarea>
                <small id="hint-ziel" class="hint">Formuliere den Zielzustand klar, nicht nur das Thema.</small>
              </label>
            </div>
            <div id="dynamic-fields-pool" class="is-hidden"></div>
          </div>

          <div class="panel">
            <div class="panel-title-row">
              <h3>Erweiterte Optionen</h3>
              <button id="toggle-advanced" type="button" class="text-btn small">▼ Optionen einblenden</button>
            </div>
            <small id="advanced-section-hint" class="hint">Diese Sektion ist ein-/ausklappbar.</small>

            <div id="advanced-fields" class="grid-2 top-space">
              <label>Zeitraum
                <select id="zeitrahmen-select"></select>
              </label>
              <label>Zeitraum (custom)
                <input id="zeitrahmen-custom" placeholder="Eigener Zeitraum" />
              </label>

              <label>Niveau
                <select id="niveau-select"></select>
              </label>
              <label>Niveau (custom)
                <input id="niveau-custom" placeholder="Eigenes Niveau" />
              </label>

              <label>Rahmen
                <select id="rahmen-select"></select>
              </label>
              <label>Rahmen (custom)
                <input id="rahmen-custom" placeholder="Eigener Rahmen" />
              </label>

              <label>Ergebnisformat
                <select id="ergebnisformat-select"></select>
              </label>
              <label>Ergebnisformat (custom)
                <input id="ergebnisformat-custom" placeholder="Eigenes Format" />
              </label>

              <label>Tonalitaet / Sprache
                <select id="ton-select"></select>
              </label>
              <label>Tonalitaet (custom)
                <input id="ton-custom" placeholder="Eigener Stil" />
              </label>
            </div>

            <label class="checkbox top-space">
              <input id="rueckfragen" type="checkbox" checked />
              <span>Kl&auml;rende R&uuml;ckfragen aktivieren</span>
            </label>
          </div>
          <div class="panel">
            <div class="panel-title-row">
              <h3>Einmaliger Template-Override (optional)</h3>
            </div>
            <label class="checkbox">
              <input id="oneoff-enable" type="checkbox" />
              <span>Nur f&uuml;r diesen Lauf ein angepasstes Template verwenden</span>
            </label>
            <div id="oneoff-fields" class="grid-2 top-space is-hidden">
              <label>Prompt Mode
                <select id="oneoff-prompt-mode">
                  <option value="">(Template-Standard)</option>
                  <option value="schema">schema</option>
                  <option value="custom">custom</option>
                </select>
              </label>
              <label>Profil (optional)
                <input id="oneoff-profile" placeholder="z. B. unterrichtsnah" />
              </label>
              <label class="span-2">Beschreibung f&uuml;r diesen Lauf
                <textarea id="oneoff-description" rows="2" placeholder="Zus&auml;tzliche Hinweise f&uuml;r den Promptaufbau"></textarea>
              </label>
              <label class="span-2">Base Prompt Override (bei custom)
                <textarea id="oneoff-base-prompt" rows="5" placeholder="Eigener Base Prompt mit {{variablen}}"></textarea>
              </label>
              <label class="span-2">Tags (CSV, optional)
                <input id="oneoff-tags" placeholder="z. B. differenzierung,projektlernen" />
              </label>
              <label class="checkbox span-2">
                <input id="oneoff-save-personal" type="checkbox" />
                <span>Als pers&ouml;nliche Template-Variante speichern</span>
              </label>
              <label class="span-2">Titel-Suffix f&uuml;r gespeicherte Variante
                <input id="oneoff-save-suffix" placeholder="z. B. (Supervisor-Testversion)" />
              </label>
            </div>
          </div>

          <div class="panel">
            <div class="panel-title-row">
              <h3>Metaprompt Vorschau</h3>
              <button id="btn-preview-metaprompt" type="button" class="secondary">Vorschau aktualisieren</button>
            </div>
            <small id="metaprompt-preview-status" class="hint"></small>
            <textarea id="metaprompt-preview" rows="8" readonly placeholder="Hier erscheint die serverseitig generierte Metaprompt-Vorschau."></textarea>
          </div>

          <div class="inline-actions">
            <button id="generate-submit" type="submit" class="cta">Prompt generieren</button>
            <small id="generation-status" class="hint"></small>
          </div>
        </form>
      </section>

      <section id="screen-result" class="screen is-hidden">
        <div class="result-layout">
          <div class="result-banner">Dein KI-Prompt ist bereit!</div>

          <div class="panel top-space result-prompt-panel">
            <div id="result-meta" class="hint"></div>
            <div class="result-prompt-box top-space">
              <button id="copy-prompt-clean" type="button" class="secondary result-copy-inside">Kopieren</button>
              <textarea id="result" rows="16" readonly></textarea>
            </div>
          </div>

          <div class="panel top-space">
            <div class="inline-actions result-actions-row">
              <button id="copy-prompt-meta" type="button" class="secondary">Kopieren (mit Metadata)</button>
              <button id="export-txt" type="button" class="secondary">Export .txt</button>
              <button id="export-md" type="button" class="secondary">Export .md</button>
              <button id="btn-compare-last" type="button" class="secondary">Mit vorheriger Version vergleichen</button>
            </div>
          </div>

          <div id="result-compare-panel" class="panel top-space is-hidden">
            <h3>Vergleich zur vorherigen Generation</h3>
            <div class="grid-2 top-space">
              <label>Aktuelle Version
                <textarea id="result-compare-current" rows="10" readonly></textarea>
              </label>
              <label>Vorherige Version
                <textarea id="result-compare-previous" rows="10" readonly></textarea>
              </label>
            </div>
          </div>

          <div class="panel top-space">
            <h3>In Bibliothek speichern</h3>
            <div class="grid-2">
              <label class="span-2">Titel
                <input id="library-title" placeholder="z. B. Stoffverteilungsplan 9. Schulstufe" />
              </label>
              <label>Bewertung
                <select id="library-rating">
                  <option value="">Keine</option>
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5">5</option>
                </select>
              </label>
              <label class="checkbox">
                <input id="library-public" type="checkbox" />
                <span>In &ouml;ffentliche Bibliothek aufnehmen</span>
              </label>
            </div>
            <div class="inline-actions top-space">
              <button id="save-library" type="button">Save to library</button>
              <small id="save-library-status" class="hint"></small>
            </div>
            <div class="inline-actions top-space">
              <small id="result-variant-status" class="hint"></small>
              <button id="btn-open-templates-from-result" type="button" class="secondary is-hidden">Template Studio &ouml;ffnen</button>
            </div>
          </div>

          <div class="inline-actions top-space result-final-actions">
            <button id="btn-adjust" type="button" class="secondary">Anpassungen vornehmen</button>
            <button id="btn-restart-from-result" type="button" class="secondary">Neue Aufgabe starten</button>
          </div>
        </div>
      </section>

      <section id="screen-dashboard" class="screen is-hidden">
        <div class="step-nav">
          <button id="btn-back-home-from-dashboard" type="button" class="link-btn">&larr; Zur&uuml;ck zur &Uuml;bersicht</button>
        </div>
        <h2>Nutzungs-Dashboard</h2>
        <p class="subline">Eigene Anfrage-Qualit&auml;t, Latenzen und Provider-Stabilit&auml;t im Blick behalten.</p>

        <div class="panel top-space">
          <div class="inline-actions">
            <label>Zeitraum
              <select id="usage-window-days">
                <option value="7">7 Tage</option>
                <option value="14">14 Tage</option>
                <option value="30" selected>30 Tage</option>
                <option value="60">60 Tage</option>
                <option value="120">120 Tage</option>
              </select>
            </label>
            <button id="usage-refresh" type="button">Aktualisieren</button>
            <small id="usage-status" class="hint"></small>
          </div>
        </div>

        <div class="grid-3 top-space">
          <div class="panel">
            <h3>Requests</h3>
            <p id="usage-total-requests" class="metric">0</p>
          </div>
          <div class="panel">
            <h3>Success Rate</h3>
            <p id="usage-success-rate" class="metric">0%</p>
          </div>
          <div class="panel">
            <h3>Ø Latenz</h3>
            <p id="usage-avg-latency" class="metric">0 ms</p>
          </div>
        </div>

        <div class="panel top-space">
          <h3>Provider &Uuml;berblick</h3>
          <div class="table-wrap top-space">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Provider</th>
                  <th>Requests</th>
                  <th>Success Rate</th>
                  <th>Ø Latenz</th>
                  <th>Letzter Fehler</th>
                </tr>
              </thead>
              <tbody id="usage-provider-body"></tbody>
            </table>
          </div>
        </div>

        <div class="panel top-space">
          <h3>Top Templates</h3>
          <ul id="usage-template-list" class="provider-list top-space"></ul>
        </div>
      </section>

      <section id="screen-library" class="screen is-hidden">
        <div class="step-nav">
          <button id="btn-back-home-from-library" type="button" class="link-btn">&larr; Zur&uuml;ck zur &Uuml;bersicht</button>
        </div>
        <h2>Bibliothek</h2>
        <p class="subline">Eigene Prompts verwalten und &ouml;ffentliche Prompts durchsuchen.</p>

        <div class="panel">
          <div class="inline-actions">
            <button id="lib-tab-own" type="button" class="secondary is-active">Meine Bibliothek</button>
            <button id="lib-tab-public" type="button" class="secondary">Public Library</button>
          </div>
          <div class="grid-3 top-space">
            <label>Kategorie
              <select id="lib-filter-category"></select>
            </label>
            <label>Unterkategorie
              <select id="lib-filter-subcategory"></select>
            </label>
            <label>Suche
              <input id="lib-filter-search" placeholder="Titel oder Inhalt" />
            </label>
          </div>
          <div class="inline-actions top-space">
            <button id="lib-refresh" type="button">Aktualisieren</button>
          </div>
        </div>

        <div id="library-list" class="library-list top-space"></div>
      </section>

      <section id="screen-templates" class="screen is-hidden">
        <div class="step-nav">
          <button id="btn-back-home-from-templates" type="button" class="link-btn">&larr; Zur&uuml;ck zur &Uuml;bersicht</button>
        </div>
        <h2>Template Studio</h2>
        <p class="subline">Pers&ouml;nliche Templates erstellen, Varianten speichern, zur Review einreichen und Community/Official verwalten.</p>

        <div class="panel top-space">
          <h3>Filter</h3>
          <div class="grid-3">
            <label>Suche
              <input id="template-filter-search" placeholder="Titel, Beschreibung, Kategorie" />
            </label>
            <label>Tag
              <input id="template-filter-tag" placeholder="z. B. differenzierung" />
            </label>
            <label>Scope
              <select id="template-filter-scope">
                <option value="">Alle</option>
                <option value="official">Official</option>
                <option value="personal">Personal</option>
                <option value="community">Community</option>
              </select>
            </label>
          </div>
          <div class="grid-3 top-space">
            <label>Review-State
              <select id="template-filter-review">
                <option value="">Alle</option>
                <option value="draft">draft</option>
                <option value="submitted">submitted</option>
                <option value="approved">approved</option>
                <option value="rejected">rejected</option>
              </select>
            </label>
            <label>Tag-Katalog
              <select id="template-tag-catalog"></select>
            </label>
            <label>Template-Bewertung (1-5)
              <input id="template-rating-value" type="number" min="1" max="5" placeholder="optional" />
            </label>
          </div>
          <div class="inline-actions top-space">
            <button id="template-refresh" type="button">Aktualisieren</button>
            <button id="template-clear-selection" type="button" class="secondary">Auswahl aufheben</button>
            <small id="template-studio-status" class="hint"></small>
          </div>
        </div>

        <div class="panel top-space">
          <h3>Template Liste</h3>
          <div id="template-list" class="list-cards"></div>
        </div>

        <div class="grid-2 top-space">
          <div class="panel">
            <h3>Taxonomie Node erstellen</h3>
            <label>Parent Node
              <select id="template-node-parent"></select>
            </label>
            <label class="top-space">Typ
              <select id="template-node-type">
                <option value="category">category</option>
                <option value="subcategory">subcategory</option>
                <option value="group">group</option>
              </select>
            </label>
            <label class="top-space">Scope
              <select id="template-node-scope">
                <option value="personal">personal</option>
                <option value="community">community</option>
                <option value="official">official</option>
              </select>
            </label>
            <label class="top-space">Name
              <input id="template-node-name" placeholder="z. B. Mathematik Sek I" />
            </label>
            <label class="top-space">Beschreibung
              <textarea id="template-node-description" rows="2"></textarea>
            </label>
            <div class="inline-actions top-space">
              <button id="template-node-create" type="button">Node erstellen</button>
            </div>
          </div>

          <div class="panel">
            <h3>Tag anlegen</h3>
            <label>Tag Key
              <input id="template-new-tag-key" placeholder="z. B. projektlernen" />
            </label>
            <label class="top-space">Anzeigename
              <input id="template-new-tag-name" placeholder="z. B. Projektlernen" />
            </label>
            <label class="top-space">Beschreibung
              <textarea id="template-new-tag-description" rows="2"></textarea>
            </label>
            <label class="checkbox top-space">
              <input id="template-new-tag-official" type="checkbox" />
              <span>Als official Tag markieren (nur Moderation)</span>
            </label>
            <div class="inline-actions top-space">
              <button id="template-tag-create" type="button">Tag speichern</button>
            </div>
          </div>
        </div>

        <div class="panel top-space">
          <h3>Template Editor</h3>
          <small id="template-selected-id" class="hint">Ausgew&auml;hlt: -</small>
          <div class="grid-2 top-space">
            <label>Title
              <input id="template-form-title" placeholder="Template Titel" />
            </label>
            <label>Scope
              <select id="template-form-scope">
                <option value="personal">personal</option>
                <option value="community">community</option>
                <option value="official">official</option>
              </select>
            </label>
            <label>Node
              <select id="template-form-node"></select>
            </label>
            <label>Profil
              <input id="template-form-profile" placeholder="unterrichtsnah | kommunikation | organisation_admin" />
            </label>
            <label class="span-2">Beschreibung
              <textarea id="template-form-description" rows="2"></textarea>
            </label>
            <label class="span-2">Required Base Fields (CSV)
              <input id="template-form-required-base" placeholder="fach,schulstufe,ziel" />
            </label>
            <label class="span-2">Optional Base Fields (CSV)
              <input id="template-form-optional-base" placeholder="zeitrahmen,niveau,rahmen,ergebnisformat,ton,rueckfragen" />
            </label>
            <label class="span-2">Tags (CSV)
              <input id="template-form-tags" placeholder="differenzierung,planung" />
            </label>
            <label>Prompt Mode
              <select id="template-form-prompt-mode">
                <option value="schema">schema</option>
                <option value="custom">custom</option>
              </select>
            </label>
            <label>Taxonomy Path (CSV)
              <input id="template-form-taxonomy-path" placeholder="Jahresplanung,Semesterplanung" />
            </label>
            <label class="span-2">Dynamic Fields (JSON Array)
              <textarea id="template-form-dynamic-fields" rows="6" placeholder='[{"id":"lernziel","label":"Lernziel","type":"text","required":true}]'></textarea>
            </label>
            <label class="span-2">Base Prompt (nur bei custom)
              <textarea id="template-form-base-prompt" rows="6"></textarea>
            </label>
            <label class="span-2">Change Note
              <input id="template-form-change-note" placeholder="Kurzbeschreibung der Aenderung" />
            </label>
            <label class="span-2">Review Note
              <input id="template-form-review-note" placeholder="Optionaler Kommentar fuer Review" />
            </label>
          </div>
          <div class="inline-actions top-space">
            <button id="template-create" type="button">Template erstellen</button>
            <button id="template-update" type="button" class="secondary">Neue Version speichern</button>
            <button id="template-submit" type="button" class="secondary">Zur Review einreichen</button>
            <button id="template-clone" type="button" class="secondary">Als persoenliche Variante speichern</button>
            <button id="template-approve" type="button" class="secondary">Approve</button>
            <button id="template-reject" type="button" class="secondary">Reject</button>
            <button id="template-rate" type="button" class="secondary">Bewertung speichern</button>
          </div>
        </div>
      </section>

      <section id="screen-admin" class="screen is-hidden">
        <div class="step-nav">
          <button id="btn-back-home-from-admin" type="button" class="link-btn">&larr; Zur&uuml;ck zur &Uuml;bersicht</button>
        </div>
        <h2>Administration</h2>
        <p class="subline">Rollen, Berechtigungen und Authentik-Gruppenzuordnungen verwalten.</p>

        <div class="grid-2 top-space">
          <div class="panel">
            <h3>Neue Rolle</h3>
            <label>Role Key
              <input id="admin-new-role-key" placeholder="z. B. content_editors" />
            </label>
            <label class="top-space">Role Name
              <input id="admin-new-role-name" placeholder="z. B. Content Editors" />
            </label>
            <label class="top-space">Beschreibung
              <textarea id="admin-new-role-description" rows="2"></textarea>
            </label>
            <div class="inline-actions top-space">
              <button id="admin-create-role" type="button">Rolle anlegen</button>
            </div>
          </div>

          <div class="panel">
            <h3>Rolle bearbeiten</h3>
            <label>Rolle
              <select id="admin-role-select"></select>
            </label>
            <label class="top-space">Role Name
              <input id="admin-role-name" />
            </label>
            <label class="top-space">Beschreibung
              <textarea id="admin-role-description" rows="2"></textarea>
            </label>
            <small id="admin-role-system" class="hint"></small>
            <div class="inline-actions top-space">
              <button id="admin-save-role" type="button">Rolle speichern</button>
              <button id="admin-delete-role" type="button" class="secondary">Rolle loeschen</button>
            </div>
          </div>
        </div>

        <div class="panel top-space">
          <h3>Neue Berechtigung</h3>
          <div class="grid-2">
            <label>Permission Key
              <input id="admin-new-permission-key" placeholder="z. B. templates.publish" />
            </label>
            <label>Beschreibung
              <input id="admin-new-permission-description" placeholder="Kurze Beschreibung" />
            </label>
          </div>
          <div class="inline-actions top-space">
            <button id="admin-create-permission" type="button">Berechtigung anlegen</button>
          </div>
        </div>

        <div class="panel top-space">
          <h3>Berechtigungen der Rolle</h3>
          <div id="admin-role-permissions" class="admin-permissions-grid top-space"></div>
          <div class="inline-actions top-space">
            <button id="admin-save-permissions" type="button">Berechtigungen speichern</button>
          </div>
        </div>

        <div class="panel top-space">
          <h3>Authentik Gruppen -> Rollen</h3>
          <div class="grid-2">
            <label>Authentik Gruppe
              <input id="admin-binding-group" placeholder="z. B. template_reviewers" />
            </label>
            <label>Rolle
              <select id="admin-binding-role"></select>
            </label>
          </div>
          <div class="inline-actions top-space">
            <button id="admin-add-binding" type="button">Zuordnung speichern</button>
          </div>
          <ul id="admin-binding-list" class="provider-list top-space"></ul>
          <small id="admin-status" class="hint"></small>
        </div>
      </section>
    </main>

    <aside id="provider-drawer" class="drawer is-hidden">
      <div class="drawer-head">
        <h2>API-Provider</h2>
        <button id="close-provider-drawer" type="button" class="text-btn">Schliessen</button>
      </div>
      <div class="drawer-body">
        <div class="panel">
          <p class="subline">API-Keys werden serverseitig verschluesselt gespeichert und nie im Klartext angezeigt.</p>
          <div class="inline-actions top-space">
            <button id="unlock-vault" type="button">Hinweis anzeigen</button>
            <button id="lock-vault" type="button" class="secondary">Status aktualisieren</button>
          </div>
          <small id="vault-status" class="hint"></small>
        </div>

        <form id="provider-form" class="panel top-space">
          <div class="grid-2">
            <label>Anzeigename
              <input id="provider-name" required placeholder="z. B. OpenAI Schule" />
            </label>
            <label>Provider
              <select id="provider-kind" required>
                <option value="openai">OpenAI</option>
                <option value="anthropic">Anthropic</option>
                <option value="mistral">Mistral</option>
                <option value="google">Google</option>
                <option value="custom">Custom API</option>
              </select>
            </label>
            <label>Modell
              <input id="provider-model" required placeholder="z. B. gpt-4o-mini" />
            </label>
            <label>API-Key
              <input id="provider-key" type="password" placeholder="leer lassen = vorhandenen Key behalten" />
            </label>
            <label class="span-2">API Base URL (optional)
              <input id="provider-base" placeholder="https://api.example.com/v1" />
            </label>
            <label class="checkbox span-2">
              <input id="provider-auto-base" type="checkbox" checked />
              <span>Empfohlene Base URL verwenden (gesperrt, bis deaktiviert)</span>
            </label>
            <small id="provider-base-hint" class="hint span-2"></small>
          </div>
          <div class="inline-actions top-space">
            <button type="submit">Provider speichern</button>
            <button id="provider-test" type="button" class="secondary">Provider testen</button>
            <button id="provider-reset" type="button" class="secondary">Formular leeren</button>
          </div>
        </form>

        <div class="panel top-space">
          <label>Aktiver Provider
            <select id="active-provider"></select>
          </label>
          <ul id="provider-list" class="provider-list top-space"></ul>
        </div>
      </div>
    </aside>

    <aside id="history-drawer" class="drawer is-hidden">
      <div class="drawer-head">
        <h2>Prompt-Verlauf</h2>
        <button id="close-history-drawer" type="button" class="text-btn">Schliessen</button>
      </div>
      <div class="drawer-body">
        <ul id="history-list" class="history-list"></ul>
      </div>
    </aside>

    <aside id="options-drawer" class="drawer is-hidden">
      <div class="drawer-head">
        <h2>Optionen</h2>
        <button id="close-options-drawer" type="button" class="text-btn">Schliessen</button>
      </div>
      <div class="drawer-body">
        <div class="panel">
          <h3>Theme</h3>
          <label class="radio"><input type="radio" name="theme" value="system" /> System</label>
          <label class="radio"><input type="radio" name="theme" value="light" /> Light</label>
          <label class="radio"><input type="radio" name="theme" value="dark" /> Dark</label>
        </div>

        <div class="panel top-space">
          <h3>Flow-Modus</h3>
          <label class="radio"><input type="radio" name="flow-mode" value="step" /> Schrittweise Ansicht</label>
          <label class="radio"><input type="radio" name="flow-mode" value="single" /> Kompaktansicht</label>
        </div>

        <div class="panel top-space">
          <h3>Standardverhalten</h3>
          <label class="checkbox"><input id="setting-copy-metadata" type="checkbox" /><span>Metadata beim Kopieren standardmaessig aktivieren</span></label>
          <label class="checkbox"><input id="setting-advanced-open" type="checkbox" /><span>Erweiterte Optionen standardmaessig offen</span></label>
          <label class="checkbox"><input id="setting-show-community" type="checkbox" /><span>Community-Templates in Katalog anzeigen</span></label>
        </div>

        <div class="inline-actions top-space">
          <button id="save-settings" type="button">Einstellungen speichern</button>
          <small id="settings-status" class="hint"></small>
        </div>
      </div>
    </aside>

    <div id="flow-choice-modal" class="modal is-hidden">
      <div class="modal-card">
        <h2>Ansicht waehlen</h2>
        <p class="subline">Du kannst das spaeter jederzeit unter Optionen aendern.</p>
        <div class="inline-actions top-space">
          <button id="choose-flow-step" type="button">Schrittweise Ansicht</button>
          <button id="choose-flow-single" type="button" class="secondary">Kompaktansicht</button>
        </div>
      </div>
    </div>

    <div id="setup-wizard-modal" class="modal is-hidden">
      <div class="modal-card">
        <h2>Schnellstart</h2>
        <p class="subline">In 3 Schritten bist du startklar:</p>
        <ol class="wizard-list top-space">
          <li>Provider einrichten (API-Provider).</li>
          <li>Verbindung testen (inkl. Modell + API-Key).</li>
          <li>Ersten Prompt generieren.</li>
        </ol>
        <div class="inline-actions top-space">
          <button id="wizard-open-provider" type="button">Provider einrichten</button>
          <button id="wizard-test-provider" type="button" class="secondary">Aktiven Provider testen</button>
          <button id="wizard-complete" type="button" class="secondary">Setup abgeschlossen</button>
          <button id="wizard-skip" type="button" class="text-btn">Sp&auml;ter</button>
        </div>
        <small id="wizard-status" class="hint top-space"></small>
      </div>
    </div>

    <div id="overlay" class="overlay is-hidden"></div>

    <script type="module" src="app.js"></script>
  </body>
</html>
