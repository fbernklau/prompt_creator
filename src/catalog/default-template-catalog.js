function defineTemplate({
  id,
  description,
  profile,
  requiredBaseFields,
  optionalBaseFields,
  dynamicFields = [],
  tags = [],
  promptMode,
  taxonomyPath,
  basePrompt,
}) {
  return {
    id,
    description,
    profile,
    requiredBaseFields,
    optionalBaseFields,
    dynamicFields,
    tags,
    promptMode: promptMode || (basePrompt ? 'custom' : 'schema'),
    taxonomyPath: Array.isArray(taxonomyPath) && taxonomyPath.length ? taxonomyPath : undefined,
    basePrompt: basePrompt || '',
  };
}

const defaultTemplateCatalog = {
  categories: {
    Jahresplanung: {
      title: 'Jahres- & Semesterplanung',
      short: 'JA',
      description: 'Strukturierung des Schuljahres nach Lehrplan.',
      templates: {
        Semesterplanung: defineTemplate({
          id: 'ja-semesterplanung',
          categoryTitle: 'Jahres- & Semesterplanung',
          templateTitle: 'Semesterplanung',
          description: 'Erstellt eine strukturierte Semesterplanung mit Kompetenzbezug und Zeitfenstern.',
          profile: 'unterrichtsnah',
          requiredBaseFields: ['fach', 'schulstufe', 'ziel'],
          optionalBaseFields: ['zeitrahmen', 'niveau', 'rahmen', 'ergebnisformat', 'ton', 'rueckfragen'],
          tags: ['planung', 'curriculum', 'semester'],
          dynamicFields: [
            { id: 'planungszeitraum', label: 'Planungszeitraum', type: 'select', required: true, options: ['Semester', 'Schuljahr', 'Quartal'] },
            { id: 'kompetenzziele', label: 'Kompetenzziele', type: 'textarea', required: true, placeholder: 'Welche Kompetenzen stehen im Fokus?' },
            { id: 'pruefungsfenster', label: 'Pruefungsfenster', type: 'text', placeholder: 'z. B. KW 45 und KW 4' },
            { id: 'reservewochen', label: 'Reservewochen einplanen', type: 'checkbox' },
          ],
        }),
        Kompetenzraster: defineTemplate({
          id: 'ja-kompetenzraster',
          categoryTitle: 'Jahres- & Semesterplanung',
          templateTitle: 'Kompetenzraster',
          description: 'Erstellt ein Kompetenzraster mit Niveaustufen und klaren Kriterien.',
          profile: 'unterrichtsnah',
          requiredBaseFields: ['fach', 'schulstufe', 'ziel'],
          optionalBaseFields: ['zeitrahmen', 'niveau', 'ergebnisformat', 'ton'],
          tags: ['planung', 'kompetenzorientierung', 'assessment'],
          dynamicFields: [
            { id: 'kompetenzbereiche', label: 'Kompetenzbereiche', type: 'textarea', required: true },
            { id: 'niveaustufen', label: 'Niveaustufen', type: 'multiselect', required: true, options: ['Basis', 'Mittel', 'Erweitert'] },
            { id: 'bewertungsskala', label: 'Bewertungsskala', type: 'select', options: ['4-stufig', '5-stufig', 'Punkte'], placeholder: 'optional' },
          ],
        }),
        Themenverteilung: defineTemplate({
          id: 'ja-themenverteilung',
          categoryTitle: 'Jahres- & Semesterplanung',
          templateTitle: 'Themenverteilung',
          description: 'Verteilt Themen ueber das Jahr inklusive Priorisierung.',
          profile: 'unterrichtsnah',
          requiredBaseFields: ['fach', 'schulstufe', 'ziel'],
          optionalBaseFields: ['zeitrahmen', 'niveau', 'rahmen', 'ergebnisformat'],
          tags: ['planung', 'stoffverteilung'],
          dynamicFields: [
            { id: 'themenliste', label: 'Themenliste', type: 'textarea', required: true, placeholder: 'Themen in Reihenfolge oder als Liste' },
            { id: 'wochenstunden', label: 'Wochenstunden', type: 'text', placeholder: 'z. B. 3 UE/Woche' },
            { id: 'priorisierung', label: 'Priorisierung', type: 'select', options: ['Muss', 'Soll', 'Kann'] },
          ],
        }),
        'Pruefungs- und Leistungsfenster': defineTemplate({
          id: 'ja-pruefungsfenster',
          categoryTitle: 'Jahres- & Semesterplanung',
          templateTitle: 'Pruefungs- und Leistungsfenster',
          description: 'Plant Leistungsnachweise mit Puffer- und Nachhollogik.',
          profile: 'unterrichtsnah',
          requiredBaseFields: ['fach', 'schulstufe', 'ziel'],
          optionalBaseFields: ['zeitrahmen', 'rahmen', 'ergebnisformat', 'ton'],
          tags: ['leistung', 'planung', 'bewertung'],
          dynamicFields: [
            { id: 'leistungsarten', label: 'Leistungsarten', type: 'multiselect', required: true, options: ['Test', 'Pruefung', 'Projekt', 'Praesentation', 'Mitarbeit'] },
            { id: 'zeitraumfenster', label: 'Zeitraumfenster', type: 'text', required: true, placeholder: 'z. B. Okt-Jan' },
            { id: 'gewichtung', label: 'Gewichtung', type: 'textarea', placeholder: 'optional' },
            { id: 'nachholmoglichkeiten', label: 'Nachholmoglichkeiten einplanen', type: 'checkbox' },
          ],
        }),
      },
    },
    Unterrichtsvorbereitung: {
      title: 'Unterrichtsvorbereitung',
      short: 'UV',
      description: 'Stundenbilder, Arbeitsauftraege und Materialien.',
      templates: {
        Stundendesign: defineTemplate({
          id: 'uv-stundendesign',
          categoryTitle: 'Unterrichtsvorbereitung',
          templateTitle: 'Stundendesign',
          description: 'Plant eine didaktisch strukturierte Unterrichtsstunde.',
          profile: 'unterrichtsnah',
          requiredBaseFields: ['fach', 'schulstufe', 'ziel'],
          optionalBaseFields: ['zeitrahmen', 'niveau', 'rahmen', 'ergebnisformat', 'ton', 'rueckfragen'],
          tags: ['unterricht', 'didaktik', 'planung'],
          dynamicFields: [
            { id: 'lernziel', label: 'Lernziel', type: 'text', required: true },
            { id: 'dauer', label: 'Dauer', type: 'select', required: true, options: ['45 Min', '50 Min', '90 Min', '100 Min'] },
            { id: 'sozialform', label: 'Sozialform', type: 'select', options: ['Einzelarbeit', 'Partnerarbeit', 'Gruppenarbeit', 'Plenum'] },
            { id: 'sicherung_transfer', label: 'Sicherung/Transfer', type: 'textarea', placeholder: 'optional' },
          ],
        }),
        Arbeitsauftraege: defineTemplate({
          id: 'uv-arbeitsauftraege',
          categoryTitle: 'Unterrichtsvorbereitung',
          templateTitle: 'Arbeitsauftraege',
          description: 'Erstellt differenzierte Arbeitsauftraege mit klaren Kriterien.',
          profile: 'unterrichtsnah',
          requiredBaseFields: ['fach', 'schulstufe', 'ziel'],
          optionalBaseFields: ['niveau', 'rahmen', 'ergebnisformat', 'ton'],
          tags: ['aufgaben', 'differenzierung', 'unterricht'],
          dynamicFields: [
            { id: 'aufgabentyp', label: 'Aufgabentyp', type: 'select', required: true, options: ['Uebung', 'Transfer', 'Problemloesen', 'Recherche'] },
            { id: 'differenzierungsziel', label: 'Differenzierungsziel', type: 'text', required: true },
            { id: 'materialhinweise', label: 'Materialhinweise', type: 'text', placeholder: 'optional' },
          ],
        }),
        Materialerstellung: defineTemplate({
          id: 'uv-materialerstellung',
          categoryTitle: 'Unterrichtsvorbereitung',
          templateTitle: 'Materialerstellung',
          description: 'Generiert Materialentwuerfe passend zum Lernziel.',
          profile: 'unterrichtsnah',
          requiredBaseFields: ['fach', 'schulstufe', 'ziel'],
          optionalBaseFields: ['niveau', 'rahmen', 'ergebnisformat', 'ton'],
          tags: ['material', 'worksheet', 'unterricht'],
          dynamicFields: [
            { id: 'materialformat', label: 'Materialformat', type: 'select', required: true, options: ['Arbeitsblatt', 'Folien', 'Checkliste', 'Handout'] },
            { id: 'thema', label: 'Thema', type: 'text', required: true },
            { id: 'loesungsblatt', label: 'Loesungsblatt mitliefern', type: 'checkbox' },
          ],
        }),
        'Einstiegs- und Abschlussphasen': defineTemplate({
          id: 'uv-einstieg-abschluss',
          categoryTitle: 'Unterrichtsvorbereitung',
          templateTitle: 'Einstiegs- und Abschlussphasen',
          description: 'Entwirft Einstiegs- oder Abschlussimpulse mit Aktivierung.',
          profile: 'unterrichtsnah',
          requiredBaseFields: ['fach', 'schulstufe', 'ziel'],
          optionalBaseFields: ['zeitrahmen', 'niveau', 'ton'],
          tags: ['unterricht', 'aktivierung', 'reflexion'],
          dynamicFields: [
            { id: 'phase', label: 'Phase', type: 'select', required: true, options: ['Einstieg', 'Abschluss'] },
            { id: 'impuls', label: 'Impuls/Ankerfrage', type: 'text', required: true },
            { id: 'reflexionsfragen', label: 'Reflexionsfragen', type: 'textarea', placeholder: 'optional' },
          ],
        }),
      },
    },
    'Individualisierung & Differenzierung': {
      title: 'Individualisierung & Foerderplaene',
      short: 'ID',
      description: 'Differenzierung fuer heterogene Lerngruppen.',
      templates: {
        Niveaustufen: defineTemplate({
          id: 'id-niveaustufen',
          categoryTitle: 'Individualisierung & Foerderplaene',
          templateTitle: 'Niveaustufen',
          description: 'Plant Aufgaben auf mehreren Niveaustufen.',
          profile: 'unterrichtsnah',
          requiredBaseFields: ['fach', 'schulstufe', 'ziel'],
          optionalBaseFields: ['zeitrahmen', 'rahmen', 'ergebnisformat', 'ton'],
          tags: ['differenzierung', 'niveau'],
          dynamicFields: [
            { id: 'thema', label: 'Thema', type: 'text', required: true },
            { id: 'niveaustufen', label: 'Niveaustufen', type: 'multiselect', required: true, options: ['Basis', 'Mittel', 'Erweitert'] },
            { id: 'erfolgskriterien', label: 'Erfolgskriterien', type: 'textarea', required: true },
          ],
        }),
        Foerdermassnahmen: defineTemplate({
          id: 'id-foerdermassnahmen',
          categoryTitle: 'Individualisierung & Foerderplaene',
          templateTitle: 'Foerdermassnahmen',
          description: 'Leitet Foerdermassnahmen aus Bedarfen ab.',
          profile: 'unterrichtsnah',
          requiredBaseFields: ['fach', 'schulstufe', 'ziel'],
          optionalBaseFields: ['zeitrahmen', 'rahmen', 'ton'],
          tags: ['foerderung', 'inklusion'],
          dynamicFields: [
            { id: 'foerderbedarf', label: 'Foerderbedarf', type: 'textarea', required: true },
            { id: 'massnahmen', label: 'Massnahmen', type: 'textarea', required: true },
            { id: 'evaluation', label: 'Evaluation/Monitoring', type: 'text', placeholder: 'optional' },
          ],
        }),
        Lernpfade: defineTemplate({
          id: 'id-lernpfade',
          categoryTitle: 'Individualisierung & Foerderplaene',
          templateTitle: 'Lernpfade',
          description: 'Erstellt adaptive Lernpfade mit Checkpoints.',
          profile: 'unterrichtsnah',
          requiredBaseFields: ['fach', 'schulstufe', 'ziel'],
          optionalBaseFields: ['zeitrahmen', 'niveau', 'ton'],
          tags: ['lernpfad', 'adaptiv'],
          dynamicFields: [
            { id: 'pfadstufen', label: 'Pfadstufen', type: 'textarea', required: true },
            { id: 'zielniveau', label: 'Zielniveau', type: 'select', required: true, options: ['Basis', 'Mittel', 'Erweitert'] },
            { id: 'checkpoint_typ', label: 'Checkpoint-Typ', type: 'select', options: ['Quiz', 'Mini-Aufgabe', 'Reflexion'] },
          ],
        }),
        Wahlaufgaben: defineTemplate({
          id: 'id-wahlaufgaben',
          categoryTitle: 'Individualisierung & Foerderplaene',
          templateTitle: 'Wahlaufgaben',
          description: 'Generiert Wahlaufgaben mit klarer Differenzierung.',
          profile: 'unterrichtsnah',
          requiredBaseFields: ['fach', 'schulstufe', 'ziel'],
          optionalBaseFields: ['niveau', 'rahmen', 'ergebnisformat'],
          tags: ['wahlaufgaben', 'differenzierung'],
          dynamicFields: [
            { id: 'themenbezug', label: 'Themenbezug', type: 'text', required: true },
            { id: 'aufgabenanzahl', label: 'Anzahl Aufgaben', type: 'select', required: true, options: ['3', '5', '7', '10'] },
            { id: 'kriterienset', label: 'Kriterienset', type: 'textarea', required: true },
          ],
        }),
      },
    },
    'Barrierefreiheit & Inklusion': {
      title: 'Barrierefreiheit',
      short: 'BI',
      description: 'Leichte Sprache, DaZ und inklusive Aufbereitung.',
      templates: {
        'Leichte Sprache': defineTemplate({
          id: 'bi-leichte-sprache',
          categoryTitle: 'Barrierefreiheit',
          templateTitle: 'Leichte Sprache',
          description: 'Transformiert Inhalte in leichte Sprache.',
          profile: 'kommunikation',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['fach', 'schulstufe', 'ton', 'ergebnisformat', 'rueckfragen'],
          tags: ['inklusion', 'sprache', 'barrierefreiheit'],
          dynamicFields: [
            { id: 'ausgangstext', label: 'Ausgangstext', type: 'textarea', required: true },
            { id: 'zielniveau', label: 'Zielniveau', type: 'select', required: true, options: ['A1', 'A2', 'B1', 'Leichte Sprache'] },
            { id: 'wortliste', label: 'Schwierige Begriffe/Wortliste', type: 'textarea', placeholder: 'optional' },
          ],
        }),
        'DaZ-Unterstuetzung': defineTemplate({
          id: 'bi-daz',
          categoryTitle: 'Barrierefreiheit',
          templateTitle: 'DaZ-Unterstuetzung',
          description: 'Erstellt sprachsensible Hilfen fuer DaZ.',
          profile: 'kommunikation',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['fach', 'schulstufe', 'ton', 'ergebnisformat'],
          tags: ['daz', 'sprachsensibel'],
          dynamicFields: [
            { id: 'sprachziel', label: 'Sprachziel', type: 'text', required: true },
            { id: 'sprachniveau', label: 'Sprachniveau', type: 'select', required: true, options: ['A1', 'A2', 'B1', 'B2'] },
            { id: 'satzstarter', label: 'Satzstarter', type: 'textarea', placeholder: 'optional' },
          ],
        }),
        'Visuelle Strukturierung': defineTemplate({
          id: 'bi-visuell',
          categoryTitle: 'Barrierefreiheit',
          templateTitle: 'Visuelle Strukturierung',
          description: 'Baut visuelle Lernhilfen und Strukturierungsvorschlaege.',
          profile: 'organisation_admin',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['fach', 'schulstufe', 'ergebnisformat'],
          tags: ['visualisierung', 'struktur'],
          dynamicFields: [
            { id: 'materialtyp', label: 'Materialtyp', type: 'text', required: true },
            { id: 'strukturhilfen', label: 'Strukturhilfen', type: 'multiselect', required: true, options: ['Icons', 'Farbcodes', 'Schrittfolge', 'Piktogramme'] },
            { id: 'farbcodierung', label: 'Farbcodierung einbauen', type: 'checkbox' },
          ],
        }),
        Nachteilsausgleich: defineTemplate({
          id: 'bi-nachteilsausgleich',
          categoryTitle: 'Barrierefreiheit',
          templateTitle: 'Nachteilsausgleich',
          description: 'Erarbeitet Nachteilsausgleichsvorschlaege fuer Leistungssettings.',
          profile: 'organisation_admin',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['fach', 'schulstufe', 'rahmen'],
          tags: ['inklusion', 'nachteilsausgleich'],
          dynamicFields: [
            { id: 'pruefungskontext', label: 'Pruefungskontext', type: 'text', required: true },
            { id: 'bedarfe', label: 'Bedarfe', type: 'textarea', required: true },
            { id: 'alternative_formate', label: 'Alternative Formate', type: 'textarea', placeholder: 'optional' },
          ],
        }),
      },
    },
    'Elternkontakte & Kommunikation': {
      title: 'Elternkontakte',
      short: 'EK',
      description: 'Elternkommunikation und sensible Gespraechsfuehrung.',
      templates: {
        Elternbrief: defineTemplate({
          id: 'ek-elternbrief',
          categoryTitle: 'Elternkontakte',
          templateTitle: 'Elternbrief',
          description: 'Erstellt einen klaren, wertschaetzenden Elternbrief.',
          profile: 'kommunikation',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['fach', 'schulstufe', 'ton', 'ergebnisformat'],
          tags: ['eltern', 'brief', 'kommunikation'],
          dynamicFields: [
            { id: 'anlass', label: 'Anlass', type: 'text', required: true },
            { id: 'zielgruppe', label: 'Zielgruppe', type: 'select', required: true, options: ['Eltern', 'Erziehungsberechtigte'] },
            { id: 'ton_kommunikation', label: 'Kommunikationston', type: 'select', required: true, options: ['wertschaetzend', 'sachlich', 'motivierend'] },
            { id: 'mehrsprachig', label: 'Mehrsprachige Version vorschlagen', type: 'checkbox' },
          ],
        }),
        Gespraechsleitfaden: defineTemplate({
          id: 'ek-gespraechsleitfaden',
          categoryTitle: 'Elternkontakte',
          templateTitle: 'Gespraechsleitfaden',
          description: 'Strukturiert Elterngespraeche mit Leitfragen und Zielbild.',
          profile: 'kommunikation',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['fach', 'schulstufe', 'ton'],
          tags: ['eltern', 'gespraech'],
          dynamicFields: [
            { id: 'gespraechsanlass', label: 'Gespraechsanlass', type: 'text', required: true },
            { id: 'teilnehmende', label: 'Teilnehmende', type: 'text', required: true },
            { id: 'leitfragen', label: 'Leitfragen', type: 'textarea', required: true },
          ],
        }),
        'Rueckmeldung zu Lernstand': defineTemplate({
          id: 'ek-rueckmeldung-lernstand',
          categoryTitle: 'Elternkontakte',
          templateTitle: 'Rueckmeldung zu Lernstand',
          description: 'Formuliert konstruktive Lernstandsrueckmeldungen.',
          profile: 'kommunikation',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['fach', 'schulstufe', 'ton', 'ergebnisformat'],
          tags: ['feedback', 'eltern'],
          dynamicFields: [
            { id: 'lernstand_kurz', label: 'Aktueller Lernstand', type: 'textarea', required: true },
            { id: 'staerken', label: 'Staerken', type: 'textarea', required: true },
            { id: 'naechste_schritte', label: 'Naechste Schritte', type: 'textarea', required: true },
          ],
        }),
        'Konfliktsensible Kommunikation': defineTemplate({
          id: 'ek-konfliktsensibel',
          categoryTitle: 'Elternkontakte',
          templateTitle: 'Konfliktsensible Kommunikation',
          description: 'Formuliert deeskalierende Kommunikation in sensiblen Situationen.',
          profile: 'kommunikation',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['fach', 'schulstufe', 'ton'],
          tags: ['konflikt', 'kommunikation'],
          dynamicFields: [
            { id: 'konfliktkontext', label: 'Konfliktkontext', type: 'textarea', required: true },
            { id: 'deeskalationsziel', label: 'Deeskalationsziel', type: 'text', required: true },
            { id: 'no_go_formulierungen', label: 'Zu vermeidende Formulierungen', type: 'textarea', placeholder: 'optional' },
          ],
        }),
      },
    },
    'Leistungsbeurteilung & Feedback': {
      title: 'Leistungsbeurteilung',
      short: 'LB',
      description: 'Bewertungsraster, Feedbacktexte und Assessment-Unterstuetzung.',
      templates: {
        Beurteilungsraster: defineTemplate({
          id: 'lb-beurteilungsraster',
          categoryTitle: 'Leistungsbeurteilung',
          templateTitle: 'Beurteilungsraster',
          description: 'Entwickelt ein kriteriumsorientiertes Beurteilungsraster.',
          profile: 'unterrichtsnah',
          requiredBaseFields: ['fach', 'schulstufe', 'ziel'],
          optionalBaseFields: ['ergebnisformat', 'ton', 'rueckfragen'],
          tags: ['bewertung', 'raster'],
          dynamicFields: [
            { id: 'kompetenzen', label: 'Kompetenzen', type: 'textarea', required: true },
            { id: 'kriterienstufen', label: 'Kriterienstufen', type: 'textarea', required: true },
            { id: 'punkteverteilung', label: 'Punkteverteilung', type: 'text', placeholder: 'optional' },
          ],
        }),
        Rubrics: defineTemplate({
          id: 'lb-rubrics',
          categoryTitle: 'Leistungsbeurteilung',
          templateTitle: 'Rubrics',
          description: 'Erstellt Rubrics mit Leistungsdimensionen und Niveaubeschreibungen.',
          profile: 'unterrichtsnah',
          requiredBaseFields: ['fach', 'schulstufe', 'ziel'],
          optionalBaseFields: ['ergebnisformat', 'ton'],
          tags: ['rubric', 'assessment'],
          dynamicFields: [
            { id: 'leistungsprodukt', label: 'Leistungsprodukt', type: 'text', required: true },
            { id: 'dimensionen', label: 'Dimensionen', type: 'textarea', required: true },
            { id: 'beschreibungsniveau', label: 'Beschreibungsniveau', type: 'select', required: true, options: ['kurz', 'mittel', 'ausfuehrlich'] },
          ],
        }),
        Feedbacktexte: defineTemplate({
          id: 'lb-feedbacktexte',
          categoryTitle: 'Leistungsbeurteilung',
          templateTitle: 'Feedbacktexte',
          description: 'Formuliert differenziertes Lernfeedback.',
          profile: 'kommunikation',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['fach', 'schulstufe', 'ton'],
          tags: ['feedback', 'beurteilung'],
          dynamicFields: [
            { id: 'feedbacktyp', label: 'Feedbacktyp', type: 'select', required: true, options: ['schriftlich', 'muendlich', 'rubric-basiert'] },
            { id: 'beobachtungen', label: 'Beobachtungen', type: 'textarea', required: true },
            { id: 'entwicklungsimpulse', label: 'Entwicklungsimpulse', type: 'textarea', required: true },
          ],
        }),
        'Selbst- und Peer-Assessment': defineTemplate({
          id: 'lb-peer-assessment',
          categoryTitle: 'Leistungsbeurteilung',
          templateTitle: 'Selbst- und Peer-Assessment',
          description: 'Plant Selbst- und Peer-Assessment mit Leitfragen.',
          profile: 'unterrichtsnah',
          requiredBaseFields: ['fach', 'schulstufe', 'ziel'],
          optionalBaseFields: ['ergebnisformat', 'ton'],
          tags: ['assessment', 'peer'],
          dynamicFields: [
            { id: 'assessmentformat', label: 'Assessmentformat', type: 'select', required: true, options: ['Selbstassessment', 'Peerassessment', 'Kombi'] },
            { id: 'leitfragen', label: 'Leitfragen', type: 'textarea', required: true },
            { id: 'bewertungsskala', label: 'Bewertungsskala', type: 'select', options: ['3-stufig', '4-stufig', '5-stufig'] },
          ],
        }),
      },
    },
    Administration: {
      title: 'Administration',
      short: 'AD',
      description: 'Dokumentation, Listen und administrative Prozesse.',
      templates: {
        Anwesenheitsdokumentation: defineTemplate({
          id: 'ad-anwesenheit',
          categoryTitle: 'Administration',
          templateTitle: 'Anwesenheitsdokumentation',
          description: 'Erstellt strukturierte Vorlagen fuer Anwesenheitsdokumentation.',
          profile: 'organisation_admin',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['ergebnisformat', 'ton'],
          tags: ['administration', 'dokumentation'],
          dynamicFields: [
            { id: 'klassengruppe', label: 'Klasse/Gruppe', type: 'text', required: true },
            { id: 'zeitraum_admin', label: 'Zeitraum', type: 'text', required: true },
            { id: 'format_admin', label: 'Format', type: 'select', required: true, options: ['Tabelle', 'Liste', 'Wochenuebersicht'] },
          ],
        }),
        'Listen & Uebersichten': defineTemplate({
          id: 'ad-listen',
          categoryTitle: 'Administration',
          templateTitle: 'Listen & Uebersichten',
          description: 'Generiert strukturierte Listen fuer Verwaltungszwecke.',
          profile: 'organisation_admin',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['ergebnisformat'],
          tags: ['administration', 'listen'],
          dynamicFields: [
            { id: 'listentyp', label: 'Listentyp', type: 'select', required: true, options: ['Material', 'Fristen', 'Teilnahme', 'Kontakte'] },
            { id: 'felder', label: 'Pflichtfelder', type: 'textarea', required: true },
            { id: 'sortierung', label: 'Sortierung/Filter', type: 'text', placeholder: 'optional' },
          ],
        }),
        Protokolle: defineTemplate({
          id: 'ad-protokolle',
          categoryTitle: 'Administration',
          templateTitle: 'Protokolle',
          description: 'Erstellt Protokollvorlagen fuer Sitzungen oder Elterngespraeche.',
          profile: 'organisation_admin',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['ton', 'ergebnisformat'],
          tags: ['protokoll', 'administration'],
          dynamicFields: [
            { id: 'meetingtyp', label: 'Meetingtyp', type: 'text', required: true },
            { id: 'teilnehmende_protokoll', label: 'Teilnehmende', type: 'textarea', required: true },
            { id: 'beschluesse', label: 'Beschluesse/ToDos', type: 'textarea', required: true },
          ],
        }),
        Fristenmanagement: defineTemplate({
          id: 'ad-fristen',
          categoryTitle: 'Administration',
          templateTitle: 'Fristenmanagement',
          description: 'Plant Fristen mit Verantwortlichkeiten und Erinnerungslogik.',
          profile: 'organisation_admin',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['ergebnisformat'],
          tags: ['fristen', 'organisation'],
          dynamicFields: [
            { id: 'fristenliste', label: 'Fristenliste', type: 'textarea', required: true },
            { id: 'verantwortliche', label: 'Verantwortliche', type: 'textarea', required: true },
            { id: 'erinnerungslogik', label: 'Erinnerungslogik', type: 'select', options: ['woechentlich', '14-taegig', 'monatlich'] },
          ],
        }),
      },
    },
    Organisation: {
      title: 'Organisation & Exkursionen',
      short: 'OR',
      description: 'Planung von Projekten, Exkursionen und Ressourcen.',
      templates: {
        Exkursionen: defineTemplate({
          id: 'or-exkursionen',
          categoryTitle: 'Organisation & Exkursionen',
          templateTitle: 'Exkursionen',
          description: 'Plant Exkursionen mit Ablauf, Sicherheit und Kommunikation.',
          profile: 'organisation_admin',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['schulstufe', 'ergebnisformat', 'ton'],
          tags: ['organisation', 'exkursion'],
          dynamicFields: [
            { id: 'zielort', label: 'Zielort', type: 'text', required: true },
            { id: 'datum', label: 'Datum/Zeitraum', type: 'text', required: true },
            { id: 'gruppe', label: 'Teilnehmende Gruppe', type: 'text', required: true },
            { id: 'risikoanalyse', label: 'Risikoanalyse', type: 'textarea', placeholder: 'optional' },
          ],
        }),
        Projektplanung: defineTemplate({
          id: 'or-projektplanung',
          categoryTitle: 'Organisation & Exkursionen',
          templateTitle: 'Projektplanung',
          description: 'Strukturiert Projekte in Phasen und Verantwortlichkeiten.',
          profile: 'organisation_admin',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['fach', 'schulstufe', 'zeitrahmen', 'ergebnisformat'],
          tags: ['projekt', 'planung'],
          dynamicFields: [
            { id: 'projektziel', label: 'Projektziel', type: 'text', required: true },
            { id: 'meilensteine', label: 'Meilensteine', type: 'textarea', required: true },
            { id: 'ressourcen', label: 'Ressourcen', type: 'textarea', placeholder: 'optional' },
          ],
        }),
        Checklisten: defineTemplate({
          id: 'or-checklisten',
          categoryTitle: 'Organisation & Exkursionen',
          templateTitle: 'Checklisten',
          description: 'Erstellt Checklisten mit Prioritaeten und Deadlines.',
          profile: 'organisation_admin',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['ergebnisformat'],
          tags: ['checkliste', 'organisation'],
          dynamicFields: [
            { id: 'checklistentyp', label: 'Checklistentyp', type: 'select', required: true, options: ['Vorbereitung', 'Durchfuehrung', 'Nachbereitung'] },
            { id: 'aufgabenpakete', label: 'Aufgabenpakete', type: 'textarea', required: true },
            { id: 'prioritaeten', label: 'Prioritaeten', type: 'textarea', placeholder: 'optional' },
          ],
        }),
        Ressourcenplanung: defineTemplate({
          id: 'or-ressourcen',
          categoryTitle: 'Organisation & Exkursionen',
          templateTitle: 'Ressourcenplanung',
          description: 'Plant Ressourcenbedarf und Engpaesse.',
          profile: 'organisation_admin',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['fach', 'zeitrahmen', 'ergebnisformat'],
          tags: ['ressourcen', 'organisation'],
          dynamicFields: [
            { id: 'ressourcenarten', label: 'Ressourcenarten', type: 'textarea', required: true },
            { id: 'verfuegbarkeit', label: 'Verfuegbarkeit', type: 'text', required: true },
            { id: 'engpaesse', label: 'Engpaesse/Alternativen', type: 'textarea', placeholder: 'optional' },
          ],
        }),
      },
    },
    'Schulentwicklung & Teamarbeit': {
      title: 'Schulentwicklung & Teamarbeit',
      short: 'ST',
      description: 'Vorlagen fuer Teamkommunikation, Konferenzen und Entwicklungsvorhaben.',
      templates: {
        Konferenzvorlage: defineTemplate({
          id: 'st-konferenzvorlage',
          categoryTitle: 'Schulentwicklung & Teamarbeit',
          templateTitle: 'Konferenzvorlage',
          description: 'Erstellt strukturierte Agenda- und Protokollvorlagen fuer Konferenzen.',
          profile: 'organisation_admin',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['ton', 'ergebnisformat'],
          tags: ['team', 'konferenz', 'organisation'],
          dynamicFields: [
            { id: 'sitzungstyp', label: 'Sitzungstyp', type: 'text', required: true },
            { id: 'agenda', label: 'Agenda', type: 'textarea', required: true },
            { id: 'entscheidungspunkte', label: 'Entscheidungspunkte', type: 'textarea', required: true },
          ],
        }),
        Fortbildungsplanung: defineTemplate({
          id: 'st-fortbildungsplanung',
          categoryTitle: 'Schulentwicklung & Teamarbeit',
          templateTitle: 'Fortbildungsplanung',
          description: 'Plant Fortbildungen mit Transfer in den Unterrichtsalltag.',
          profile: 'organisation_admin',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['fach', 'zeitrahmen', 'ergebnisformat'],
          tags: ['fortbildung', 'team'],
          dynamicFields: [
            { id: 'fortbildungsziel', label: 'Fortbildungsziel', type: 'text', required: true },
            { id: 'zielgruppe_team', label: 'Zielgruppe im Team', type: 'text', required: true },
            { id: 'transferplan', label: 'Transferplan', type: 'textarea', required: true },
          ],
        }),
        Teamkommunikation: defineTemplate({
          id: 'st-teamkommunikation',
          categoryTitle: 'Schulentwicklung & Teamarbeit',
          templateTitle: 'Teamkommunikation',
          description: 'Formuliert Team-Updates und interne Kommunikation.',
          profile: 'kommunikation',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['ton', 'ergebnisformat'],
          tags: ['team', 'kommunikation'],
          dynamicFields: [
            { id: 'anlass_team', label: 'Anlass', type: 'text', required: true },
            { id: 'kernbotschaft', label: 'Kernbotschaft', type: 'textarea', required: true },
            { id: 'naechste_schritte_team', label: 'Naechste Schritte', type: 'textarea', required: true },
          ],
        }),
        Qualitaetsentwicklung: defineTemplate({
          id: 'st-qualitaetsentwicklung',
          categoryTitle: 'Schulentwicklung & Teamarbeit',
          templateTitle: 'Qualitaetsentwicklung',
          description: 'Unterstuetzt Entwicklungsprozesse mit Indikatoren und Massnahmen.',
          profile: 'organisation_admin',
          requiredBaseFields: ['ziel'],
          optionalBaseFields: ['zeitrahmen', 'ergebnisformat'],
          tags: ['qualitaet', 'entwicklung'],
          dynamicFields: [
            { id: 'entwicklungsfeld', label: 'Entwicklungsfeld', type: 'text', required: true },
            { id: 'indikatoren', label: 'Indikatoren', type: 'textarea', required: true },
            { id: 'massnahmenplan', label: 'Massnahmenplan', type: 'textarea', required: true },
          ],
        }),
      },
    },
  },
  presetOptions: {
    zeitrahmen: ['', '1 Stunde', '2 Stunden', 'Halbtag', 'Tag', 'Woche', 'Monat', '__custom__'],
    niveau: ['', 'Basis', 'Mittel', 'Erweitert', 'Heterogen', '__custom__'],
    rahmen: ['', 'DaZ', 'Teamteaching', 'Digital', 'Inklusiv', 'Pruefung', '__custom__'],
    ergebnisformat: ['', 'Liste', 'Tabelle', 'Ablaufplan', 'Rubric', 'Checkliste', '__custom__'],
    ton: ['', 'klar', 'sachlich', 'formal', 'praezise', 'motivierend', 'einfach', '__custom__'],
  },
};

module.exports = { defaultTemplateCatalog };
